<!doctype html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <title>Inverter Analytics — Solar Monitoring</title>
    <style>
      body{font-family:system-ui,Segoe UI,Arial,sans-serif}
      main{padding:24px}
      .row{display:flex;gap:12px;flex-wrap:wrap;align-items:end;margin:12px 0}
      label{font-size:12px;color:#444;display:block;margin-bottom:4px}
      input,button{padding:8px 10px;border:1px solid #ccc;border-radius:8px}
      button{cursor:pointer}
      .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-top:16px}
      .card{border:1px solid #e5e5e5;border-radius:12px;padding:14px;background:#fff}
      .k{font-size:12px;color:#666}
      .v{font-size:22px;font-weight:700}
      .err{color:#b00020;margin-top:8px}
      .muted{color:#666;font-size:13px}
      code{background:#f5f5f5;padding:2px 6px;border-radius:6px}
    </style>
  </head>
  <body>
<!-- ===== Top Nav (auto-injected) ===== -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap" rel="stylesheet">
<style>
  .topnav{position:sticky;top:0;z-index:50;background:#ffffffcc;backdrop-filter:saturate(180%) blur(8px);
          border-bottom:1px solid #e5e7eb}
  .topnav .inner{max-width:1400px;margin:0 auto;padding:10px 16px;display:flex;gap:16px;align-items:center}
  .brand{font:700 18px/1 Inter,system-ui,sans-serif;color:#0f172a;letter-spacing:.2px;margin-right:8px}
  .tabs{display:flex;gap:6px;flex-wrap:wrap}
  .tab{font:500 13px/1 Inter,system-ui,sans-serif;color:#0f172a;text-decoration:none;
       padding:8px 10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff}
  .tab:hover{border-color:#c7d2fe}
  .tab.active{background:#eef2ff;color:#1e3a8a;border-color:#c7d2fe;font-weight:700}
  @media (max-width:720px){ .brand{display:none} }
</style>
<nav class="topnav">
  <div class="inner">
    <div class="brand">Solar Plant Dashboard</div>
    <div class="tabs">
      <a class="tab" href="/meter.html"                 data-file="meter.html">Meter</a>
      <a class="tab" href="/inverter_analytics.html"    data-file="inverter_analytics.html">Inverter Analytics</a>
      <a class="tab" href="/inverter_data_overview.html"data-file="inverter_data_overview.html">Inverter Data Overview</a>
      <a class="tab" href="/inverter_faults.html"       data-file="inverter_faults.html">Inverter Faults</a>
      <a class="tab" href="/maintenance.html"           data-file="maintenance.html">Maintenance</a>
    </div>
  </div>
</nav>
<script>
// highlight current tab by file name
(function(){
  var file = (location.pathname.split('/').pop() || 'meter.html').toLowerCase();
  document.querySelectorAll('.topnav .tab').forEach(function(a){
    if((a.getAttribute('data-file')||'').toLowerCase()===file){ a.classList.add('active'); }
  });
})();
</script>
<!-- ===== End Top Nav ===== -->
    <div id='nav-holder'></div>
    <script>
      fetch('/nav.html').then(r => r.text()).then(html => {
        document.getElementById('nav-holder').outerHTML = html;
      });
    </script>

    <main>
      <h1>Inverter Analytics</h1>
      <p class='muted'>Shows placeholder PR & CUF from <code>/api/inverter/analytics/summary</code> (we'll wire real SQL next).</p>

      <div class='row'>
        <div>
          <label for='plantId'>Plant ID</label>
          <input id='plantId' value='DEMO'/>
        </div>
        <div>
          <label for='days'>Window (days, 1–31)</label>
          <input id='days' type='number' min='1' max='31' value='3'/>
        </div>
        <div>
          <button id='btnLoad'>Load</button>
        </div>
        <div class='muted' id='status' style='margin-left:8px'></div>
      </div>

      <div id='error' class='err'></div>

      <div class='cards' id='cards' style='display:none'>
        <div class='card'><div class='k'>PR</div><div class='v' id='pr'>—</div></div>
        <div class='card'><div class='k'>CUF</div><div class='v' id='cuf'>—</div></div>
        <div class='card'><div class='k'>Energy Export (kWh)</div><div class='v' id='exp'>—</div></div>
        <div class='card'><div class='k'>Theoretical (kWh)</div><div class='v' id='theo'>—</div></div>
        <div class='card'><div class='k'>Capacity (MW)</div><div class='v' id='cap'>—</div></div>
        <div class='card'><div class='k'>From</div><div class='v' id='from'>—</div></div>
        <div class='card'><div class='k'>To</div><div class='v' id='to'>—</div></div>
      </div>
    </main>

    <script>
      const btn = document.getElementById('btnLoad');
      const status = document.getElementById('status');
      const err = document.getElementById('error');
      const cards = document.getElementById('cards');

      const el = id => document.getElementById(id);

      async function loadSummary(){
        const plantId = el('plantId').value.trim();
        const days = Math.max(1, Math.min(31, parseInt(el('days').value||'3',10)));
        err.textContent=''; status.textContent='Loading…'; cards.style.display='none';

        if(!plantId){ err.textContent='Please enter Plant ID'; status.textContent=''; return; }

        try{
          const url = \/api/inverter/analytics/summary?plantId=\&days=\\;
          const res = await fetch(url);
          if(!res.ok) throw new Error('API error '+res.status);
          const j = await res.json();

          el('pr').textContent = (j.PR ?? 0).toFixed ? (j.PR*100).toFixed(0)+'%' : String(j.PR);
          el('cuf').textContent = (j.CUF ?? 0).toFixed ? (j.CUF*100).toFixed(0)+'%' : String(j.CUF);
          el('exp').textContent = j.energyExportKWh?.toLocaleString?.() ?? j.energyExportKWh ?? '—';
          el('theo').textContent = j.theoreticalKWh?.toLocaleString?.() ?? j.theoreticalKWh ?? '—';
          el('cap').textContent = j.capacityMW ?? '—';
          el('from').textContent = new Date(j.from).toLocaleString();
          el('to').textContent = new Date(j.to).toLocaleString();

          status.textContent = \Plant \ • \ day(s)\;
          cards.style.display='';
        }catch(e){
          err.textContent = e.message || String(e);
          status.textContent='';
        }
      }

      btn.addEventListener('click', loadSummary);
      window.addEventListener('DOMContentLoaded', loadSummary);
    </script>
  <!-- ===== Small Footer ===== -->
<style>
  .sp-footer{margin-top:12px;border-top:1px solid #e5e7eb;background:#fff}
  .sp-footer .inner{max-width:1400px;margin:0 auto;padding:10px 16px;
    display:flex;gap:10px;justify-content:space-between;align-items:center;
    font:500 12px/1.4 Inter,system-ui,sans-serif;color:#64748b}
  .sp-footer a{color:#2563eb;text-decoration:none}
  .sp-footer a:hover{text-decoration:underline}
</style>
<footer class="sp-footer">
  <div class="inner">
    <div>© Solar Plant Dashboard</div>
    <div><a href="/meter.html">Meter</a> · <a href="/inverter_analytics.html">Inverter Analytics</a> · <a href="/maintenance.html">Maintenance</a></div>
  </div>
</footer>
<!-- ===== End Footer ===== -->
</body>
</html>





